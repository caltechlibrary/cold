<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Caltech Library's Digital Library Development Sandbox</title>
    
    <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<header>
<span id="library_logo"><a href="http://library.caltech.edu"><img src="/assets/liblogo.gif" alt="Caltech Library logo"></a></span>
<span id="project_logo"><img src="/assets/iceberg-sketch.png" alt="Iceberg logo for cold"></span>
</header>
<nav>
<ul>
<li>
<a href="/">Home</a>
</li>
<li>
<a href="/app/">Dashboard</a>
</li>
<li>
<a href="/app/help.html">Help</a>
</li>
<li>
<a href="/app/about.html">About</a>
</li>
<li>
<a href="/Shibboleth.sso/Logout">Logout</a>
</li>
</ul>
</nav>

<section>
<h1 id="cold---controlled-object-list-daemon">
cold - (C)ontrolled (o)bject (l)ist (d)aemon
</h1>
<p>
This repository implements a service to maintain a controlled list of
objects at Caltech Library for people and groups.
</p>
<h1 id="requirements">
Requirements
</h1>
<ul>
<li>
MySQL 8
</li>
<li>
To build the UI and compile the <strong>cold</strong> daemon
<ul>
<li>
GNU Make
</li>
<li>
<a href="https://github.com/caltechlibrary/mkpage">MkPage</a> (to build
UI)
</li>
<li>
<a href="https://pandoc.org">Pandoc</a> (to build UI)
</li>
<li>
Golang (for compiling the service, needed when updating static
vocabularies)
</li>
</ul>
</li>
</ul>
<h2 id="overview">
Overview
</h2>
<p>
Caltech Library maintains a list of people, groups and funders and their
related pids. This started being managed in Google Sheets, then in CSV
files but the number of objects in envoled has increased and it make
sense to provide a more robust implementation allowing for easier
curation of the list. The objects are relatively flat. Here’s an example
JSON object representing R. S. Doiel showing the internal identifier
named “cl_people_id”, name object, email, orcid and Caltech affiliation
is shown both via a boolean field and a ROR.
</p>
<pre><code>{
    &quot;cl_people_id&quot;: &quot;Doiel-R-S&quot;,
    &quot;family_name&quot;: &quot;Doiel&quot;,
    &quot;given_name&quot;: &quot;Robert&quot;,
    &quot;orcid&quot;: &quot;0000-0003-0900-6903&quot;,
    &quot;authors_id&quot;: &quot;Doiel-R-S&quot;,
    &quot;directory_id&quot;: &quot;rsdoiel&quot;,
    &quot;caltech&quot;: true,
    &quot;status&quot;: &quot;Active&quot;,
    &quot;directory_person_type&quot;: &quot;Staff&quot;,
    &quot;division&quot;: &quot;Libraries Group&quot;,
    &quot;updated&quot;: &quot;2022-03-09&quot;
    &quot;ror&quot;: &quot;https://ror.org/05dxps055&quot;
} </code></pre>
<p>
A group object for Caltech Library is also flat.
</p>
<pre><code>{
    &quot;cl_group_id&quot;: &quot;Caltech-Library&quot;,
    &quot;name&quot;: &quot;Caltech Library&quot;,
    &quot;alternative&quot;: &quot;Caltech Library System; Library System Papers and Publications&quot;,
    &quot;updated&quot;: &quot;2020-03-26 00:00:00&quot;
}</code></pre>
<p>
Some objects may have more attributes others less. A simple table schema
containing a row id, an internal identifier (e.g. cl_people_id,
cl_group_id), a “field” and a “value” can be used to represent all the
types of fields associated with a given object. A separate table can be
used for person, group and finder with the individual objects stored as
a JSON type. This is well suited to a data collection that has sparse
consistency (e.g. one person might have an ORCID but not a research id,
the next might have a viaf or wikidata id but not a ORCID).
</p>
<pre><code>CREATE TABLE people (cl_people_id VARCHAR(255) PRIMARY KEY, object JSON);
CREATE TABLE local_group (cl_group_id VARCHAR(255) PRIMARY KEY, object JSON);
&lt;!-- CREATE TABLE funder (cl_funder_id VARCHAR(255) PRIMARY KEY, object JSON); --&gt;</code></pre>
<h2 id="approach">
Approach
</h2>
<p>
This service is intended to run on localhost on a known port
(e.g. localhost:8486). It is a mininal service relying on access control
from the operating system or front-end web service (e.g. Apache 2 with
Shibboleth). The goal of the service is to provide a light weight layer
between the database storing the objects and the applications that need
to work with them. Like ep3apid and datasetd <em>cold</em> is configured
using a simple JSON “settings.json” file. Typically this would be stored
in a sub-folder of “etc” on the system
(e.g. /usr/local/etc/cold/settings.json).
</p>
<p>
The service is made up of two parts, a set of “End Points” for managing
and retrieving controlled object lists and vocabularies as JSON
expressions and a set of static files providing the user interface to
manage and display the vocabularies and controlled object lists. The
static website is build from HTML, CSS, JavaScript relying on Web
Components for providing a human friendly interface.
</p>
<h2 id="end-points">
End Points
</h2>
<p>
JSON service defined end points are formed as the following. The
following end point descriptions support the GET method.
</p>
<dl>
<dt>
<code>/</code>
</dt>
<dd>
A description of the service
</dd>
<dt>
<code>/api/version</code>
</dt>
<dd>
Returns the version number of the service
</dd>
<dt>
<code>/api/people</code>
</dt>
<dd>
Returns a list of “cl_people_id” managed by <em>cold</em>
</dd>
<dt>
<code>/api/people/{CL_PEOPLE_ID}</code>
</dt>
<dd>
For a GET returns a people object, a PUT will create the people object,
POST will replace the people object and DELETE will remove the people
object
</dd>
<dt>
<code>/api/group</code>
</dt>
<dd>
Returns a list of “cl_group_id” managed by <em>cold</em>
</dd>
<dt>
<code>/api/group/{CL_GROUP_ID}</code>
</dt>
<dd>
For a GET returns a group object, a PUT will create the group object,
POST will replace the group object and DELETE will remove the group
object
</dd>
</dl>
<h2 id="crosswalks">
Crosswalks
</h2>
<p>
A cross walk lets you put in a collection name (e.g. people, group), a
field name and a value and it returns a list of matching records.
</p>
<dl>
<dt>
<code>/api/crosswalk/people/{IDENTIFIER_NAME}/{IDENTIFIER}</code>
</dt>
<dd>
Returns a list of “cl_people_id” assocated with that identifier
</dd>
<dt>
<code>/api/crosswalk/group/{IDENTIFIER_NAME}/{IDENTIFIER}</code>
</dt>
<dd>
Returns a list of “cl_group__id” assocated with that identifier
</dd>
</dl>
<p>
<em>cold</em> takes a REST approach to updates for managed objects. PUT
will create a new object, POST will update it, GET will retrieve it and
DELETE will remove it.
</p>
<h2 id="vocabularies">
Vocabularies
</h2>
<p>
<em>cold</em> also supports end points for stable vocabularies mapping
an indentifier to a normalized name. These are set at compile time
because they are so slow changing.
</p>
<dl>
<dt>
<code>/api/subject</code>
</dt>
<dd>
Returns a list of all the subject ids (codes)
</dd>
<dt>
<code>/api/subject/{SUBJECT_ID}</code>
</dt>
<dd>
Returns the normalized text string for that subject id
</dd>
<dt>
<code>/api/issn</code>
</dt>
<dd>
Returns a list of issn that are mapped to a publisher name
</dd>
<dt>
<code>/api/issn/{ISSN}</code>
</dt>
<dd>
Returns the normalized publisher name for that ISSN
</dd>
<dt>
<code>/api/doi-prefix</code>
</dt>
<dd>
Returns a list of DOI prefixes that map to a normalize name
</dd>
<dt>
<code>/api/doi-prefix/{DOI_PREFIX}</code>
</dt>
<dd>
Returns the normalized publisher name for that DOI prefix
</dd>
</dl>
<h1 id="manage-interface">
Manage interface
</h1>
<p>
The management inteface is avialable at <code>/app/dashboard.html</code>
path. This provides a dashboard which then interacts with the JSON side
of the service to update content. The manage interface is built from Web
Components and requires JavaScript to be enabled in the browser.
</p>
<h2 id="widgets">
Widgets
</h2>
<p>
Widgets provide the user interface for humans to manage and view the
objects. While <strong>cold</strong> can directly host these it is
equally possible to integrate the static components into another system,
web service or web site. They are only static web assets. The public
facing web service needs to control access to <strong>cold</strong> and
the static content does not contain anything that is priviliged. The
Widgets can be loaded indepentently in the page using the following end
points.
</p>
<dl>
<dt>
<code>/widgets/person.js</code>
</dt>
<dd>
This JavaScript file provides a display and input set of web components
for our Person Object. Markup example <code>&lt;person-display
honorific=“Mr.” given=“R. S.” family=“Doiel” lineage=“”
orcid=“0000-0003-0900-6903”&gt;&lt;/person-display&gt;</code> and
<code>&lt;person-input honorific=“Mr.” given=“R. S.” family=“Doiel”
lineage=“” orcid=“0000-0003-0900-6903”&gt;&lt;/person-input&gt;</code>
</dd>
<dt>
<code>/widgets/group.js</code>
</dt>
<dd>
This JavaScript file provides a display and input set of web components
for our Markup example <code>&lt;group-display name=“GALCIT”
ror=““&gt;&lt;/group-display&gt;</code> and <code>&lt;group-input
name=”GALCIT” ror=“” label=““&gt;&lt;/group-input&gt;</code>
</dd>
</dl>
<!--

`/widgets/funder.js`
: This JavaScript file provides a display and input set of web components for our Markup example `<funder-display name="NSF" grant_number="1.203221" ror="" doi=""></funder-display>` and `<funder-input  name="NSF" grant_number="1.203221" doi="" ror="" label="Grant details"></funder-input>`

-->
<dl>
<dt>
<code>/widgets/vocabulary.js</code>
</dt>
<dd>
This JavaScript file provides a identifier/name web component suitable
for displaying subjects, issn/publisher info and doi-prefix/publisher
info.
</dd>
</dl>
</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2022 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
